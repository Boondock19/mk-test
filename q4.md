# QUERIES CUARTA CONSULTA

## ORIGINAL
GroupAggregate  (cost=3201365.20..3881239.40 rows=237732 width=60) (actual time=33352.179..36906.082 rows=218156 loops=1)
  Group Key: tf.flight_id, tf.fare_conditions
  ->  Incremental Sort  (cost=3201365.20..3781480.29 rows=7742997 width=39) (actual time=33352.162..36087.046 rows=7920956 loops=1)
        Sort Key: tf.flight_id, tf.fare_conditions
        Presorted Key: tf.flight_id
        Full-sort Groups: 100380  Sort Method: quicksort  Average Memory: 30kB  Peak Memory: 30kB
        Pre-sorted Groups: 49901  Sort Method: quicksort  Average Memory: 32kB  Peak Memory: 32kB
        ->  Merge Join  (cost=3201362.83..3330021.08 rows=7742997 width=39) (actual time=33352.091..34688.045 rows=7920956 loops=1)
              Merge Cond: (f.flight_id = tf.flight_id)
              ->  Index Scan using flights_pkey on flights f  (cost=0.42..8781.66 rows=198251 width=4) (actual time=166.123..202.896 rows=198430 loops=1)
                    Filter: ((status)::text = 'Arrived'::text)
                    Rows Removed by Filter: 16437
              ->  Sort  (cost=3201358.22..3222338.12 rows=8391960 width=39) (actual time=33185.902..33725.791 rows=8391852 loops=1)
                    Sort Key: tf.flight_id
                    Sort Method: external sort  Disk: 438672kB
                    ->  Merge Join  (cost=1059468.92..1777317.63 rows=8391960 width=39) (actual time=17168.339..29500.853 rows=8391852 loops=1)
                          Merge Cond: (tf.ticket_no = t.ticket_no)
                          ->  Index Scan using ticket_flights_pkey on ticket_flights tf  (cost=0.56..570990.18 rows=8391960 width=32) (actual time=0.025..9214.806 rows=8391852 loops=1)
                          ->  Sort  (cost=1059468.36..1066844.57 rows=2950486 width=21) (actual time=17168.267..17678.360 rows=8391851 loops=1)
                                Sort Key: t.ticket_no
                                Sort Method: external sort  Disk: 101072kB
                                ->  Merge Join  (cost=517011.68..621378.44 rows=2950486 width=21) (actual time=5125.180..6389.920 rows=2949857 loops=1)
                                      Merge Cond: (b.book_ref = t.book_ref)
                                      ->  Index Only Scan using bookings_pkey on bookings b  (cost=0.43..54835.08 rows=2111110 width=7) (actual time=0.013..177.788 rows=2111110 loops=1)
                                            Heap Fetches: 0
                                      ->  Sort  (cost=517009.77..524385.99 rows=2950486 width=21) (actual time=5125.124..5362.709 rows=2949857 loops=1)
                                            Sort Key: t.book_ref
                                            Sort Method: external sort  Disk: 101072kB
                                            ->  Seq Scan on tickets t  (cost=0.00..78919.86 rows=2950486 width=21) (actual time=0.033..245.278 rows=2949857 loops=1)
Planning Time: 0.740 ms
JIT:
  Functions: 27
  Options: Inlining true, Optimization true, Expressions true, Deforming true
  Timing: Generation 0.565 ms, Inlining 36.307 ms, Optimization 78.943 ms, Emission 50.949 ms, Total 166.764 ms
Execution Time: 36980.283 ms


## VALOR DEL CUARTO QUERY CON DELAYED 

GroupAggregate  (cost=1527040.80..1569229.07 rows=1406 width=60) (actual time=3487.123..4344.690 rows=41 loops=1)
  Group Key: tf.flight_id, tf.fare_conditions
  ->  Incremental Sort  (cost=1527040.80..1569193.92 rows=1406 width=39) (actual time=3487.104..4344.431 rows=1428 loops=1)
        Sort Key: tf.flight_id, tf.fare_conditions
        Presorted Key: tf.flight_id
        Full-sort Groups: 18  Sort Method: quicksort  Average Memory: 30kB  Peak Memory: 30kB
        Pre-sorted Groups: 14  Sort Method: quicksort  Average Memory: 31kB  Peak Memory: 31kB
        ->  Nested Loop  (cost=1525837.00..1569111.95 rows=1406 width=39) (actual time=3479.487..4343.948 rows=1428 loops=1)
              ->  Nested Loop  (cost=1525836.57..1568471.72 rows=1406 width=39) (actual time=3479.458..4337.053 rows=1428 loops=1)
                    ->  Merge Join  (cost=1525836.14..1567801.80 rows=1406 width=32) (actual time=3479.348..4329.975 rows=1428 loops=1)
                          Merge Cond: (tf.flight_id = f.flight_id)
                          ->  Sort  (cost=1520521.18..1541501.08 rows=8391960 width=32) (actual time=3436.769..4018.221 rows=8310873 loops=1)
                                Sort Key: tf.flight_id
                                Sort Method: external merge  Disk: 348360kB
                                ->  Seq Scan on ticket_flights tf  (cost=0.00..153852.60 rows=8391960 width=32) (actual time=111.598..699.965 rows=8391852 loops=1)
                          ->  Sort  (cost=5310.77..5310.86 rows=36 width=4) (actual time=12.001..12.019 rows=41 loops=1)
                                Sort Key: f.flight_id
                                Sort Method: quicksort  Memory: 26kB
                                ->  Seq Scan on flights f  (cost=0.00..5309.84 rows=36 width=4) (actual time=0.046..11.981 rows=41 loops=1)
                                      Filter: ((status)::text = 'Delayed'::text)
                                      Rows Removed by Filter: 214826
                    ->  Index Scan using tickets_pkey on tickets t  (cost=0.43..0.48 rows=1 width=21) (actual time=0.005..0.005 rows=1 loops=1428)
                          Index Cond: (ticket_no = tf.ticket_no)
              ->  Index Only Scan using bookings_pkey on bookings b  (cost=0.43..0.46 rows=1 width=7) (actual time=0.005..0.005 rows=1 loops=1428)
                    Index Cond: (book_ref = t.book_ref)
                    Heap Fetches: 0
Planning Time: 0.491 ms
JIT:
  Functions: 25
  Options: Inlining true, Optimization true, Expressions true, Deforming true
  Timing: Generation 0.877 ms, Inlining 6.824 ms, Optimization 62.499 ms, Emission 42.321 ms, Total 112.521 ms
Execution Time: 4381.750 ms
